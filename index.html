<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IFL Playoff Predictor</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');
  body {
    font-family: 'Orbitron', sans-serif;
    background: #121212;
    color: #eee;
    margin: 0; padding: 0;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh;
  }
  header {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 1rem 0 2rem 0;
    color: #00ffff;
    text-shadow: 0 0 10px #00ffff;
  }
  .stage {
    width: 95vw;
    max-width: 700px;
    margin-bottom: 3rem;
  }
  h2 {
    border-bottom: 2px solid #00ffff;
    padding-bottom: 0.3rem;
    margin-bottom: 1rem;
  }
  .division-group {
    margin-bottom: 1.5rem;
  }
  .division-title {
    font-size: 1.3rem;
    margin-bottom: 0.7rem;
    color: #00d7ff;
    text-shadow: 0 0 5px #00d7ff;
  }
  .team-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }
  .team-card {
    background: #222;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    user-select: none;
    border: 2px solid transparent;
    transition: all 0.2s ease;
    min-width: 140px;
    text-align: center;
  }
  .team-card.selected {
    border-color: #00ffff;
    background: #004d4d;
    color: #00ffff;
    font-weight: 700;
  }
  .team-card.disabled {
    opacity: 0.4;
    pointer-events: none;
  }
  button {
    background: #00ffff;
    border: none;
    padding: 12px 25px;
    border-radius: 8px;
    color: #111;
    font-weight: 700;
    font-size: 1.1rem;
    cursor: pointer;
    box-shadow: 0 0 10px #00ffff;
    transition: background 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #00d7ff;
  }
  button:disabled {
    background: #005050;
    cursor: not-allowed;
    box-shadow: none;
  }
  .matchup-container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 2rem;
  }
  .matchup {
    background: #222;
    border-radius: 8px;
    padding: 10px;
    width: 280px;
    box-shadow: 0 0 8px #00ffff;
  }
  .matchup h3 {
    text-align: center;
    margin-bottom: 12px;
    color: #00ffff;
  }
  .matchup .team-option {
    background: #111;
    margin: 5px 0;
    padding: 8px;
    border-radius: 5px;
    cursor: pointer;
    border: 2px solid transparent;
    text-align: center;
    font-weight: 600;
  }
  .matchup .team-option.selected {
    border-color: #00ffff;
    background: #004d4d;
    color: #00ffff;
  }
  .champion-display {
    font-size: 2rem;
    font-weight: 700;
    color: #00ffcc;
    text-align: center;
    margin-top: 2rem;
    text-shadow: 0 0 10px #00ffcc;
  }
  @media (max-width: 480px) {
    .team-card {
      min-width: 100%;
    }
    .matchup {
      width: 100%;
    }
  }
</style>
</head>
<body>
<header>IFL Playoff Predictor</header>

<div id="stage-1" class="stage">
  <h2>Stage 1: Pick Division Winners (1 per division)</h2>
  <div class="division-group" id="world-east">
    <div class="division-title">World East Division</div>
    <div class="team-list"></div>
  </div>
  <div class="division-group" id="world-central">
    <div class="division-title">World Central Division</div>
    <div class="team-list"></div>
  </div>
  <div class="division-group" id="world-west">
    <div class="division-title">World West Division</div>
    <div class="team-list"></div>
  </div>
  <button id="to-stage-2" disabled>Next: Select Wildcards</button>
</div>

<div id="stage-2" class="stage" style="display:none;">
  <h2>Stage 2: Pick 5 Wildcard Teams</h2>
  <div class="team-list" id="wildcard-list"></div>
  <button id="to-stage-3" disabled>Next: Build Bracket</button>
</div>

<div id="stage-3" class="stage" style="display:none;">
  <h2>Stage 3: Playoff Bracket</h2>
  <div class="matchup-container" id="quarterfinals"></div>
  <div class="matchup-container" id="semifinals" style="display:none;"></div>
  <div class="matchup-container" id="final" style="display:none;"></div>
  <div class="champion-display" id="champion" style="display:none;"></div>
</div>

<script>
  // Data: teams by division
  const divisions = {
    "World East Division": [
      "Australia Whites",
      "Italia Bulls",
      "Belarus Barbarians",
      "Singapore Smelters",
      "South Korea Deers",
      "Poland Panthers"
    ],
    "World Central Division": [
      "Germany Cavaliers",
      "UK 3 Lions",
      "Finaland Frigate",
      "Belgium Bulldogs",
      "Holland Hornets",
      "South Africa Silverbacks"
    ],
    "World West Division": [
      "USA Drones",
      "Jamaica Thunder",
      "Rwanda Raiders",
      "Egypt Pharaohs",
      "Peru Piranhas",
      "Brazil Hummingbirds"
    ]
  };

  // State to store selections
  let divisionWinners = {};
  let wildcardTeams = [];
  let quarterFinalWinners = [];
  let semiFinalWinners = [];
  let finalWinner = null;

  // Stage 1 elements
  const stage1 = document.getElementById("stage-1");
  const toStage2Btn = document.getElementById("to-stage-2");

  // Stage 2 elements
  const stage2 = document.getElementById("stage-2");
  const wildcardList = document.getElementById("wildcard-list");
  const toStage3Btn = document.getElementById("to-stage-3");

  // Stage 3 elements
  const stage3 = document.getElementById("stage-3");
  const quarterfinalsDiv = document.getElementById("quarterfinals");
  const semifinalsDiv = document.getElementById("semifinals");
  const finalDiv = document.getElementById("final");
  const championDiv = document.getElementById("champion");

  // Utility: create team card
  function createTeamCard(teamName) {
    const card = document.createElement("div");
    card.className = "team-card";
    card.textContent = teamName;
    return card;
  }

  // Populate Stage 1
  function populateStage1() {
    Object.entries(divisions).forEach(([divisionName, teams]) => {
      const divisionGroup = [...document.querySelectorAll(".division-group")]
        .find(dg => dg.querySelector(".division-title").textContent === divisionName);
      const list = divisionGroup.querySelector(".team-list");
      list.innerHTML = "";
      teams.forEach(team => {
        const card = createTeamCard(team);
        card.addEventListener("click", () => {
          // Toggle selection: only one per division
          if (divisionWinners[divisionName] === team) {
            delete divisionWinners[divisionName];
            card.classList.remove("selected");
          } else {
            divisionWinners[divisionName] = team;
            // Deselect other cards in this division
            Array.from(list.children).forEach(c => c.classList.remove("selected"));
            card.classList.add("selected");
          }
          updateToStage2Btn();
        });
        list.appendChild(card);
      });
    });
  }

  function updateToStage2Btn() {
    const allSelected = Object.keys(divisions).every(div => divisionWinners.hasOwnProperty(div));
    toStage2Btn.disabled = !allSelected;
  }

  toStage2Btn.addEventListener("click", () => {
    stage1.style.display = "none";
    stage2.style.display = "block";
    populateStage2();
  });

  // Populate Stage 2 - Wildcards
  function populateStage2() {
    wildcardList.innerHTML = "";
    // Get all teams except division winners
    const divisionWinnerSet = new Set(Object.values(divisionWinners));
    const allTeams = Object.values(divisions).flat();
    const remainingTeams = allTeams.filter(t => !divisionWinnerSet.has(t));
    remainingTeams.forEach(team => {
      const card = createTeamCard(team);
      card.addEventListener("click", () => {
        if (card.classList.contains("selected")) {
          card.classList.remove("selected");
          wildcardTeams = wildcardTeams.filter(t => t !== team);
        } else {
          if (wildcardTeams.length < 5) {
            card.classList.add("selected");
            wildcardTeams.push(team);
          } else {
            alert("You can only select 5 wildcard teams.");
            return;
          }
        }
        updateToStage3Btn();
      });
      wildcardList.appendChild(card);
    });
    wildcardTeams = [];
    updateToStage3Btn();
  }

  function updateToStage3Btn() {
    toStage3Btn.disabled = wildcardTeams.length !== 5;
  }

  toStage3Btn.addEventListener("click", () => {
    stage2.style.display = "none";
    stage3.style.display = "block";
    setupBracket();
  });

  // Stage 3: Bracket builder
  /*
  Quarterfinals = 8 teams (3 division winners + 5 wildcards)
  We will create 4 matchups: QF1, QF2, QF3, QF4
  Then semifinals: SF1, SF2
  Then final.
  */

  // Utilities to create matchup UI
  function createMatchup(id, teams, onPick) {
    const container = document.createElement("div");
    container.className = "matchup";
    container.id = id;

    const titleMap = {
      "qf1": "Quarterfinal 1",
      "qf2": "Quarterfinal 2",
      "qf3": "Quarterfinal 3",
      "qf4": "Quarterfinal 4",
      "sf1": "Semifinal 1",
      "sf2": "Semifinal 2",
      "final": "Final"
    };

    const title = document.createElement("h3");
    title.textContent = titleMap[id] || id;
    container.appendChild(title);

    teams.forEach(team => {
      const tOption = document.createElement("div");
      tOption.className = "team-option";
      tOption.textContent = team;
      tOption.addEventListener("click", () => {
        // Select this team, deselect other
        const siblings = container.querySelectorAll(".team-option");
        siblings.forEach(s => s.classList.remove("selected"));
        tOption.classList.add("selected");
        onPick(team);
      });
      container.appendChild(tOption);
    });

    return container;
  }

  // Setup bracket
  function setupBracket() {
    quarterfinalsDiv.innerHTML = "";
    semifinalsDiv.innerHTML = "";
    finalDiv.innerHTML = "";
    championDiv.style.display = "none";
    championDiv.textContent = "";

    // Combine teams
    const quarterFinalTeams = [
      ...Object.values(divisionWinners),
      ...wildcardTeams
    ];

    // For simplicity, just assign first 2 vs last 2 wildcard in quarterfinals and so on
    // You can adjust seeding logic here

    // Example matchups:
    // QF1: divisionWinner1 vs wildcard1
    // QF2: divisionWinner2 vs wildcard2
    // QF3: divisionWinner3 vs wildcard3
    // QF4: wildcard4 vs wildcard5

    // Sort division winners alphabetically for consistent pairing
    const dwSorted = Object.values(divisionWinners).sort();
    const wSorted = wildcardTeams.slice().sort();

    let qfMatchups = [
      [dwSorted[0], wSorted[0]],
      [dwSorted[1], wSorted[1]],
      [dwSorted[2], wSorted[2]],
      [wSorted[3], wSorted[4]],
    ];

    // Track picks
    quarterFinalWinners = [null, null, null, null];
    semiFinalWinners = [null, null];
    finalWinner = null;

    // Create quarterfinal matchups
    qfMatchups.forEach((teams, idx) => {
      const id = "qf" + (idx + 1);
      const matchupDiv = createMatchup(id, teams, (winner) => {
        quarterFinalWinners[idx] = winner;
        updateSemifinals();
      });
      quarterfinalsDiv.appendChild(matchupDiv);
    });

    semifinalsDiv.style.display = "none";
    finalDiv.style.display = "none";
  }

  // Update semifinals once all quarterfinal winners are selected
  function updateSemifinals() {
    if (quarterFinalWinners.includes(null)) {
      // Not all quarterfinals picked
      semifinalsDiv.style.display = "none";
      finalDiv.style.display = "none";
      championDiv.style.display = "none";
      return;
    }

    semifinalsDiv.style.display = "flex";
    semifinalMatchups = [
      [quarterFinalWinners[0], quarterFinalWinners[1]],
      [quarterFinalWinners[2], quarterFinalWinners[3]]
    ];

    semifinalsDiv.innerHTML = "";
    semiFinalWinners = [null, null];

    semifinalMatchups.forEach((teams, idx) => {
      const id = "sf" + (idx + 1);
      const matchupDiv = createMatchup(id, teams, (winner) => {
        semiFinalWinners[idx] = winner;
        updateFinal();
      });
      semifinalsDiv.appendChild(matchupDiv);
    });

    finalDiv.style.display = "none";
    championDiv.style.display = "none";
  }

  // Update final once both semifinal winners picked
  function updateFinal() {
    if (semiFinalWinners.includes(null)) {
      finalDiv.style.display = "none";
      championDiv.style.display = "none";
      return;
    }

    finalDiv.style.display = "flex";
    finalDiv.innerHTML = "";
    finalWinner = null;

    const matchupDiv = createMatchup("final", semiFinalWinners, (winner) => {
      finalWinner = winner;
      showChampion();
    });
    finalDiv.appendChild(matchupDiv);

    championDiv.style.display = "none";
  }

  // Show champion
  function showChampion() {
    if (!finalWinner) return;
    championDiv.textContent = `Champion: ${finalWinner}`;
    championDiv.style.display = "block";
  }

  // Initial setup
  populateStage1();
</script>

</body>
</html>
